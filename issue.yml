base_task:
  variables:
    backlog_bin: '{{arg1}}'
    command: 'issues'
    refresh_all: ''
    source_command: '{{backlog_bin}} {{command}} {{refresh_all}} 2>/dev/null | {{yml_dir}}/bin/one_line_issue.py'
  source: '{{source_command}}'
  delimiter: ':'
  binds:
    alt-u:
      - 'execute-silent[{{backlog_bin}} issue-urls {+1,2} | tr " " "\n" | pbcopy]'
    alt-o:
      - 'execute-silent[open $({{backlog_bin}} issue-urls {+1,2})]'
    alt-r:
      - 'execute-silent[{{backlog_bin}} delete-issues-cache {+1}]'
      - 'reload[{{source_command}}]'
    ctrl-alt-h:
      - 'execute-silent[{{backlog_bin}} update-issue-status MITAIOU {+1,2}]'
      - 'execute-silent[{{backlog_bin}} delete-issues-cache {+1}]'
      - 'reload[{{source_command}}]'
    ctrl-alt-j:
      - 'execute-silent[{{backlog_bin}} update-issue-status TAIOUCHUU {+1,2}]'
      - 'execute-silent[{{backlog_bin}} delete-issues-cache {+1}]'
      - 'reload[{{source_command}}]'
    ctrl-alt-k:
      - 'execute-silent[{{backlog_bin}} update-issue-status SYORIZUMI {+1,2}]'
      - 'execute-silent[{{backlog_bin}} delete-issues-cache {+1}]'
      - 'reload[{{source_command}}]'
    ctrl-alt-l:
      - 'execute-silent[{{backlog_bin}} update-issue-status KANRYOU {+1,2}]'
      - 'execute-silent[{{backlog_bin}} delete-issues-cache {+1}]'
      - 'reload[{{source_command}}]'
  options:
    - with-nth=2..
    - ansi
    - reverse
    - multi
    - 'query=!:完了: '
    - no-sort
  post_operations:
    enter:
      - pipe: fzfyml4 nth-tool -d ":" "2,5.." | sed 's/:/ /' | tee >(pbcopy)
    alt-enter:
      - pipe: awk -F ':' '{print $2}' | tee >(pbcopy)
task_switch:
  alt-a:
    variables:
      command: 'issues-across-projects'

